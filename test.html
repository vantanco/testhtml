<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 0px;
            background: #f7f7f7;
        }
        n8n-demo {
	--n8n-frame-background-color: black;
	--n8n-json-background-color: lightgray;
	--n8n-copy-button-background-color: green;
	--n8n-workflow-min-height: 400px;
	--n8n-iframe-border-radius: 30px
}
    </style>

    <!-- Polyfills cho Web Components -->
    <script src="https://cdn.jsdelivr.net/npm/@webcomponents/webcomponentsjs@2.0.0/webcomponents-loader.js"></script>
    <!-- Polyfill cho Lit -->
    <script src="https://www.unpkg.com/lit@2.0.0-rc.2/polyfill-support.js"></script>
    <!-- Component chÃ­nh tá»« n8n -->
    <script type="module" src="https://cdn.jsdelivr.net/npm/@n8n_io/n8n-demo-component/n8n-demo.bundled.js"></script>
</head>

<body>

    <n8n-demo
        workflow="{&quot;nodes&quot;:[{&quot;parameters&quot;:{&quot;content&quot;:&quot;## ðŸŸ¢ LUá»’NG 1 - Xá»¬ LÃ LINK áº¢NH&quot;,&quot;height&quot;:240,&quot;width&quot;:1040},&quot;type&quot;:&quot;n8n-nodes-base.stickyNote&quot;,&quot;position&quot;:[60,-560],&quot;typeVersion&quot;:1,&quot;id&quot;:&quot;f48818e2-fc4e-44c9-ad3b-4c00d5d74bf6&quot;,&quot;name&quot;:&quot;Sticky Note&quot;},{&quot;parameters&quot;:{&quot;method&quot;:&quot;POST&quot;,&quot;url&quot;:&quot;https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal&quot;,&quot;sendBody&quot;:true,&quot;bodyParameters&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;app_id&quot;,&quot;value&quot;:&quot;cli_a7f18af293f8502f&quot;},{&quot;name&quot;:&quot;app_secret&quot;,&quot;value&quot;:&quot;j81seeCJEOlT4hXmMR6YFcywnz8VyrM8&quot;}]},&quot;options&quot;:{&quot;response&quot;:{&quot;response&quot;:{}}}},&quot;type&quot;:&quot;n8n-nodes-base.httpRequest&quot;,&quot;typeVersion&quot;:4.2,&quot;position&quot;:[140,-220],&quot;id&quot;:&quot;94369ba3-f10c-4b8f-a142-f7f9280cb9d8&quot;,&quot;name&quot;:&quot;HTTP Request - Láº¥y Token Lark&quot;},{&quot;parameters&quot;:{&quot;jsCode&quot;:&quot;return items.map(item =&gt; {\n    if (item.Text) {\n        item.Text = item.Text.replace(/\\n/g, &#39; &#39;); // XÃ³a táº¥t cáº£ xuá»‘ng dÃ²ng vÃ  thay báº±ng khoáº£ng tráº¯ng\n    }\n    return item;\n});&quot;},&quot;type&quot;:&quot;n8n-nodes-base.code&quot;,&quot;typeVersion&quot;:2,&quot;position&quot;:[900,-220],&quot;id&quot;:&quot;6c6034e6-b3d6-47aa-a75e-caa0b4830c73&quot;,&quot;name&quot;:&quot;Code - XÃ³a xuá»‘ng dÃ²ng trong Text&quot;},{&quot;parameters&quot;:{&quot;url&quot;:&quot;https://open.larksuite.com/open-apis/bitable/v1/apps/HYEqb9gOYaUzRYsrooMlhXeigIe/tables/tblRVOHixZWWBc2Y/records&quot;,&quot;sendQuery&quot;:true,&quot;queryParameters&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;page_size&quot;,&quot;value&quot;:&quot;20&quot;},{&quot;name&quot;:&quot;view_id&quot;,&quot;value&quot;:&quot;vewkRtteE3&quot;}]},&quot;sendHeaders&quot;:true,&quot;headerParameters&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;Authorization&quot;,&quot;value&quot;:&quot;=Bearer {{ $json.tenant_access_token }}&quot;}]},&quot;options&quot;:{&quot;response&quot;:{&quot;response&quot;:{&quot;fullResponse&quot;:true}}}},&quot;type&quot;:&quot;n8n-nodes-base.httpRequest&quot;,&quot;typeVersion&quot;:4.2,&quot;position&quot;:[400,-220],&quot;id&quot;:&quot;5a64b369-c4a5-4e0e-8dfc-3ec266e6887c&quot;,&quot;name&quot;:&quot;HTTP Request - Láº¥y thÃ´ng tin báº£ng Lark&quot;},{&quot;parameters&quot;:{&quot;method&quot;:&quot;POST&quot;,&quot;url&quot;:&quot;https://open.larksuite.com/open-apis/bitable/v1/apps/HYEqb9gOYaUzRYsrooMlhXeigIe/tables/tblRVOHixZWWBc2Y/records/batch_update&quot;,&quot;sendHeaders&quot;:true,&quot;headerParameters&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;Authorization&quot;,&quot;value&quot;:&quot;=Bearer {{ $json[\&quot;Token lark\&quot;] }}&quot;}]},&quot;sendBody&quot;:true,&quot;specifyBody&quot;:&quot;json&quot;,&quot;jsonBody&quot;:&quot;={\n  \&quot;records\&quot;: [\n    {\n      \&quot;fields\&quot;: {\n        \&quot;Import tin nháº¯n\&quot;: \&quot;{{ $json.Text }}\&quot;,\n        \&quot;Import hÃ¬nh áº£nh\&quot;: \&quot;{{ $json.direct_link }}\&quot;\n      },\n      \&quot;record_id\&quot;: \&quot;{{ $json[\&quot;láº¥y hÃ ng Ä‘áº§u tiÃªn\&quot;].record_id }}\&quot;\n    }\n  ]\n}&quot;,&quot;options&quot;:{&quot;response&quot;:{&quot;response&quot;:{}}}},&quot;type&quot;:&quot;n8n-nodes-base.httpRequest&quot;,&quot;typeVersion&quot;:4.2,&quot;position&quot;:[1400,-380],&quot;id&quot;:&quot;520998cc-0308-47cc-b8a8-346ffdd9a0c6&quot;,&quot;name&quot;:&quot;HTTP Request - CÃ¢p nháº­t dá»¯ liá»‡u vÃ o báº£ng Lark&quot;},{&quot;parameters&quot;:{&quot;pollTimes&quot;:{&quot;item&quot;:[{&quot;mode&quot;:&quot;everyMinute&quot;}]},&quot;documentId&quot;:{&quot;__rl&quot;:true,&quot;value&quot;:&quot;https://docs.google.com/spreadsheets/d/1jkVEBQlkUAf_itGJB_9vPjNKVElFDibyLH6YsaTYj98/edit?usp=sharing&quot;,&quot;mode&quot;:&quot;url&quot;},&quot;sheetName&quot;:{&quot;__rl&quot;:true,&quot;value&quot;:&quot;gid=0&quot;,&quot;mode&quot;:&quot;list&quot;,&quot;cachedResultName&quot;:&quot;Trang tÃ­nh1&quot;,&quot;cachedResultUrl&quot;:&quot;https://docs.google.com/spreadsheets/d/1jkVEBQlkUAf_itGJB_9vPjNKVElFDibyLH6YsaTYj98/edit#gid=0&quot;},&quot;options&quot;:{}},&quot;type&quot;:&quot;n8n-nodes-base.googleSheetsTrigger&quot;,&quot;typeVersion&quot;:1,&quot;position&quot;:[-160,-360],&quot;id&quot;:&quot;03a27b1d-0a50-47ed-8adf-a51f452d6b5f&quot;,&quot;name&quot;:&quot;Google Sheets Trigger - KÃ­ch hoáº¡t khi cÃ³ thay Ä‘á»•i trong Google Sheets&quot;,&quot;credentials&quot;:{&quot;googleSheetsTriggerOAuth2Api&quot;:{&quot;id&quot;:&quot;gxZMwO3oU7BzOiNF&quot;,&quot;name&quot;:&quot;Ngá»c NgÃ¢n&quot;}}},{&quot;parameters&quot;:{&quot;assignments&quot;:{&quot;assignments&quot;:[{&quot;id&quot;:&quot;31cac9ad-9f40-4e65-8195-889b10eb25f6&quot;,&quot;name&quot;:&quot;url&quot;,&quot;value&quot;:&quot;={{ $json[\&quot;HÃ¬nh áº£nh\&quot;] }}&quot;,&quot;type&quot;:&quot;string&quot;}]},&quot;options&quot;:{}},&quot;type&quot;:&quot;n8n-nodes-base.set&quot;,&quot;typeVersion&quot;:3.4,&quot;position&quot;:[500,-480],&quot;id&quot;:&quot;ab744780-2edd-470c-ab5f-223e5e7de0cb&quot;,&quot;name&quot;:&quot;Edit Fields - Thiáº¿t láº­p URL hÃ¬nh áº£nh&quot;},{&quot;parameters&quot;:{&quot;mode&quot;:&quot;combine&quot;,&quot;combineBy&quot;:&quot;combineAll&quot;,&quot;options&quot;:{}},&quot;type&quot;:&quot;n8n-nodes-base.merge&quot;,&quot;typeVersion&quot;:3,&quot;position&quot;:[1200,-380],&quot;id&quot;:&quot;53d305f9-d031-4d1b-98ca-7294befab2e0&quot;,&quot;name&quot;:&quot;Merge - Káº¿t há»£p dá»¯ liá»‡u&quot;},{&quot;parameters&quot;:{&quot;jsCode&quot;:&quot;// Nháº­n dá»¯ liá»‡u Ä‘áº§u vÃ o tá»« n8n\nconst inputData = items.map(item =&gt; item.json);\n\n// HÃ m chuyá»ƒn Ä‘á»•i link Google Drive\nfunction convertGDriveLink(inputUrl) {\n    let match = inputUrl.match(/\\/file\\/d\\/([a-zA-Z0-9_-]+)\\//);\n    \n    if (match) {\n        let fileId = match[1];\n        let directLink = `https://drive.google.com/uc?export=download&amp;id=${fileId}`;\n        return { direct_link: directLink };\n    } else {\n        return { error: \&quot;URL khÃ´ng há»£p lá»‡. Vui lÃ²ng kiá»ƒm tra láº¡i.\&quot; };\n    }\n}\n\n// Xá»­ lÃ½ táº¥t cáº£ cÃ¡c má»¥c Ä‘áº§u vÃ o tá»« n8n\nconst outputData = inputData.map(data =&gt; ({\n    json: convertGDriveLink(data.url) // \&quot;url\&quot; lÃ  key chá»©a link gá»‘c tá»« input\n}));\n\n// Tráº£ vá» káº¿t quáº£ dÆ°á»›i dáº¡ng array (Ä‘Ãºng Ä‘á»‹nh dáº¡ng n8n yÃªu cáº§u)\nreturn outputData;\n&quot;},&quot;type&quot;:&quot;n8n-nodes-base.code&quot;,&quot;typeVersion&quot;:2,&quot;position&quot;:[820,-480],&quot;id&quot;:&quot;9bb97492-f839-4e0e-b013-a074e642c1d1&quot;,&quot;name&quot;:&quot;Code - Chuyá»ƒn Ä‘á»•i URL áº£nh thÃ nh liÃªn káº¿t táº£i xuá»‘ng&quot;},{&quot;parameters&quot;:{&quot;assignments&quot;:{&quot;assignments&quot;:[{&quot;id&quot;:&quot;68512b65-d676-4915-9c08-0502fccd8e83&quot;,&quot;name&quot;:&quot;láº¥y hÃ ng Ä‘áº§u tiÃªn&quot;,&quot;value&quot;:&quot;={{ $json.body.data.items[0] }}&quot;,&quot;type&quot;:&quot;object&quot;},{&quot;id&quot;:&quot;cf8498cd-d187-4e9a-9e40-deac561440f4&quot;,&quot;name&quot;:&quot;Text&quot;,&quot;value&quot;:&quot;={{ $(&#39;Google Sheets Trigger - KÃ­ch hoáº¡t khi cÃ³ thay Ä‘á»•i trong Google Sheets&#39;).item.json.Text }}&quot;,&quot;type&quot;:&quot;string&quot;},{&quot;id&quot;:&quot;e2858bc3-f4a7-47a2-871d-dbec87ee91a1&quot;,&quot;name&quot;:&quot;HÃ¬nh áº£nh&quot;,&quot;value&quot;:&quot;={{ $(&#39;Google Sheets Trigger - KÃ­ch hoáº¡t khi cÃ³ thay Ä‘á»•i trong Google Sheets&#39;).item.json[&#39;HÃ¬nh áº£nh&#39;] }}&quot;,&quot;type&quot;:&quot;string&quot;},{&quot;id&quot;:&quot;35143b66-2a99-4d03-bc46-23001e4a7d42&quot;,&quot;name&quot;:&quot;Token lark&quot;,&quot;value&quot;:&quot;={{ $(&#39;HTTP Request - Láº¥y Token Lark&#39;).item.json.tenant_access_token }}&quot;,&quot;type&quot;:&quot;string&quot;}]},&quot;options&quot;:{}},&quot;type&quot;:&quot;n8n-nodes-base.set&quot;,&quot;typeVersion&quot;:3.4,&quot;position&quot;:[660,-220],&quot;id&quot;:&quot;e1f0801a-4fb3-4485-9e24-236dc2c6a2ed&quot;,&quot;name&quot;:&quot;Edit Fields - Thiáº¿t láº­p cÃ¡c trÆ°á»ng cáº§n thiáº¿t&quot;},{&quot;parameters&quot;:{},&quot;type&quot;:&quot;n8n-nodes-base.wait&quot;,&quot;typeVersion&quot;:1.1,&quot;position&quot;:[160,-480],&quot;id&quot;:&quot;b7407995-0cd3-4aad-a146-f0ef69c989eb&quot;,&quot;name&quot;:&quot;Wait - Chá» xem hÃ¬nh áº£nh cÃ³ Ä‘Æ°á»£c upload khÃ´ng&quot;,&quot;webhookId&quot;:&quot;66f0b4a3-61b8-4d8f-bcff-04bbeb44bd7a&quot;}],&quot;connections&quot;:{&quot;HTTP Request - Láº¥y Token Lark&quot;:{&quot;main&quot;:[[{&quot;node&quot;:&quot;HTTP Request - Láº¥y thÃ´ng tin báº£ng Lark&quot;,&quot;type&quot;:&quot;main&quot;,&quot;index&quot;:0}]]},&quot;Code - XÃ³a xuá»‘ng dÃ²ng trong Text&quot;:{&quot;main&quot;:[[{&quot;node&quot;:&quot;Merge - Káº¿t há»£p dá»¯ liá»‡u&quot;,&quot;type&quot;:&quot;main&quot;,&quot;index&quot;:1}]]},&quot;HTTP Request - Láº¥y thÃ´ng tin báº£ng Lark&quot;:{&quot;main&quot;:[[{&quot;node&quot;:&quot;Edit Fields - Thiáº¿t láº­p cÃ¡c trÆ°á»ng cáº§n thiáº¿t&quot;,&quot;type&quot;:&quot;main&quot;,&quot;index&quot;:0}]]},&quot;Google Sheets Trigger - KÃ­ch hoáº¡t khi cÃ³ thay Ä‘á»•i trong Google Sheets&quot;:{&quot;main&quot;:[[{&quot;node&quot;:&quot;HTTP Request - Láº¥y Token Lark&quot;,&quot;type&quot;:&quot;main&quot;,&quot;index&quot;:0},{&quot;node&quot;:&quot;Wait - Chá» xem hÃ¬nh áº£nh cÃ³ Ä‘Æ°á»£c upload khÃ´ng&quot;,&quot;type&quot;:&quot;main&quot;,&quot;index&quot;:0}]]},&quot;Edit Fields - Thiáº¿t láº­p URL hÃ¬nh áº£nh&quot;:{&quot;main&quot;:[[{&quot;node&quot;:&quot;Code - Chuyá»ƒn Ä‘á»•i URL áº£nh thÃ nh liÃªn káº¿t táº£i xuá»‘ng&quot;,&quot;type&quot;:&quot;main&quot;,&quot;index&quot;:0}]]},&quot;Merge - Káº¿t há»£p dá»¯ liá»‡u&quot;:{&quot;main&quot;:[[{&quot;node&quot;:&quot;HTTP Request - CÃ¢p nháº­t dá»¯ liá»‡u vÃ o báº£ng Lark&quot;,&quot;type&quot;:&quot;main&quot;,&quot;index&quot;:0}]]},&quot;Code - Chuyá»ƒn Ä‘á»•i URL áº£nh thÃ nh liÃªn káº¿t táº£i xuá»‘ng&quot;:{&quot;main&quot;:[[{&quot;node&quot;:&quot;Merge - Káº¿t há»£p dá»¯ liá»‡u&quot;,&quot;type&quot;:&quot;main&quot;,&quot;index&quot;:0}]]},&quot;Edit Fields - Thiáº¿t láº­p cÃ¡c trÆ°á»ng cáº§n thiáº¿t&quot;:{&quot;main&quot;:[[{&quot;node&quot;:&quot;Code - XÃ³a xuá»‘ng dÃ²ng trong Text&quot;,&quot;type&quot;:&quot;main&quot;,&quot;index&quot;:0}]]},&quot;Wait - Chá» xem hÃ¬nh áº£nh cÃ³ Ä‘Æ°á»£c upload khÃ´ng&quot;:{&quot;main&quot;:[[{&quot;node&quot;:&quot;Edit Fields - Thiáº¿t láº­p URL hÃ¬nh áº£nh&quot;,&quot;type&quot;:&quot;main&quot;,&quot;index&quot;:0}]]}},&quot;pinData&quot;:{},&quot;meta&quot;:{&quot;templateCredsSetupCompleted&quot;:true,&quot;instanceId&quot;:&quot;ef41f4c07afa34f2499e4a94dd6e8d33c0bd5f833bd2b3ac5dba8f9f31afa64f&quot;}}"

        collapseformobile="false"
        clicktointeract="true"
        hidecanvaserrors="true"
        theme="light"
    ></n8n-demo>

</body>

</html>
